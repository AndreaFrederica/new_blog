---
import { getEntry, render } from "astro:content";
import Markdown from "@components/misc/Markdown.astro";
import { siteConfig } from "../config";
import I18nKey from "../i18n/i18nKey";
import { i18n } from "../i18n/translation";
import MainGridLayout from "../layouts/MainGridLayout.astro";
import { getLicenseName, licenses } from "../licenses";

// Load default language license spec content
const licensePost = await getEntry("spec", "license");

if (!licensePost) {
	throw new Error("License page content not found (spec/license.md)");
}

const { Content } = await render(licensePost);
const currentLang = siteConfig.defaultLang || siteConfig.lang || "zh_cn";
---
<MainGridLayout title={i18n(I18nKey.licenses, currentLang)} description={i18n(I18nKey.licenses, currentLang)} lang={siteConfig.defaultLang || siteConfig.lang}>
  <div class="flex w-full overflow-hidden relative min-h-32">
    <div class="card-base z-10 px-9 py-6 relative w-full">
      <Markdown class="mt-2">
        <Content />
      </Markdown>
      
      <div class="mt-8">
        <h2 class="text-2xl font-bold mb-4 text-neutral-900 dark:text-neutral-100">{i18n(I18nKey.availableLicenses, currentLang)}</h2>
        <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
          {licenses.map((license) => (
            <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
              <h3 class="font-semibold text-lg mb-2">
                <a href={license.url} class="text-blue-600 dark:text-blue-400 hover:underline">
                  {getLicenseName(license.id, currentLang)}
                </a>
              </h3>
              <p class="text-sm text-gray-600 dark:text-gray-400">
                ID: {license.id}
              </p>
              {license.doc && (
                <p class="text-xs text-gray-500 dark:text-gray-500 mt-1">
                  {i18n(I18nKey.containsDetailedDocumentation, currentLang)}
                </p>
              )}
            </div>
          ))}
        </div>
      </div>
    </div>
  </div>
</MainGridLayout>

